# Easy ERP 前端E2E测试用例完整指南

## 测试环境配置

### 测试环境
- **测试URL**: `http://localhost:3000`
- **测试浏览器**: Chrome, Firefox, Safari, Edge
- **测试分辨率**: 1920×1080, 1366×768, 375×667 (移动端)
- **测试工具**: Cypress / Playwright

### 测试用户配置
```javascript
const testUsers = {
  admin: {
    username: 'admin@easyerp.com',
    password: 'Admin@123456',
    role: '系统管理员'
  },
  purchaseManager: {
    username: 'purchase.manager@easyerp.com',
    password: 'Purchase@2024',
    role: '采购经理'
  },
  warehouseAdmin: {
    username: 'warehouse.admin@easyerp.com',
    password: 'Warehouse@2024',
    role: '仓库管理员'
  },
  financeUser: {
    username: 'finance.user@easyerp.com',
    password: 'Finance@2024',
    role: '财务人员'
  }
};
```

## 登录与认证测试

### TC001: 正常登录流程
**测试路径**: `/login` → `/dashboard`

**测试步骤**:
1. 访问登录页面 `/login`
2. 输入用户名 `admin@easyerp.com`
3. 输入密码 `Admin@123456`
4. 输入验证码（如启用）
5. 点击"登录"按钮
6. 验证成功跳转到 `/dashboard`
7. 验证顶部导航栏显示用户名

**断言检查**:
- [ ] URL应变为 `/dashboard`
- [ ] 页面应显示"欢迎回来"消息
- [ ] 侧边栏应显示完整菜单
- [ ] 用户头像应显示正确

### TC002: 登录失败场景
**测试路径**: `/login` → 错误提示

**测试场景**:
1. **错误密码测试**
   - 输入正确用户名和错误密码
   - 验证错误提示"用户名或密码错误"

2. **空值提交测试**
   - 留空用户名/密码字段
   - 验证前端表单验证提示

3. **验证码错误测试**
   - 输入错误验证码
   - 验证验证码刷新功能

4. **SQL注入防护测试**
   - 输入恶意SQL代码
   - 验证系统安全处理

## 产品管理模块测试

### TC003: 完整产品创建流程
**测试路径**: `/products/products` → 新建产品 → 产品详情

**测试步骤**:
1. 导航到产品管理页面 `/products/products`
2. 点击"新建产品"按钮
3. 填写产品基本信息:
   - 产品名称: "iPhone 15 Pro Max 测试机"
   - 产品代码: "TEST-IP15PM-001"
   - SKU: "TEST-SKU-001"
   - ASIN: "B0TEST12345"
4. 选择产品分类: "智能手机" → "iPhone系列"
5. 填写规格参数:
   - 重量: 221g
   - 尺寸: 159.9×76.7×8.25mm
   - 颜色: "黑色钛金属"
6. 上传产品图片:
   - 主图: 上传正面图片
   - 副图: 上传侧面、背面图片
   - 设置主图封面
7. 填写包装信息:
   - 内箱尺寸: 20×15×8cm
   - 外箱尺寸: 45×35×25cm
   - 每箱数量: 20台
8. 选择关联店铺: "智能科技旗舰店"
9. 点击"保存"按钮
10. 验证产品列表中显示新产品

**断言检查**:
- [ ] 产品列表显示新产品
- [ ] 产品详情页显示完整信息
- [ ] 图片正确显示并可预览
- [ ] 分类关联正确

### TC004: 产品搜索与筛选
**测试路径**: `/products/products` → 搜索 → 筛选结果

**测试场景**:
1. **关键词搜索**
   - 搜索"iPhone"
   - 验证结果包含iPhone相关产品

2. **分类筛选**
   - 选择分类"智能手机"
   - 验证结果仅显示该分类产品

3. **店铺筛选**
   - 选择店铺"智能科技旗舰店"
   - 验证结果仅显示该店铺产品

4. **多条件组合筛选**
   - 搜索"小米" + 分类"智能手机" + 店铺筛选
   - 验证结果精确匹配

5. **空结果处理**
   - 搜索不存在的产品
   - 验证友好的空状态提示

### TC005: 产品图片管理
**测试路径**: `/products/products` → 产品详情 → 图片管理

**测试步骤**:
1. 进入产品详情页
2. 点击"图片管理"标签
3. 上传新图片:
   - 选择本地图片文件
   - 验证图片预览功能
   - 验证图片大小限制提示
4. 设置主图:
   - 选择一张图片设为封面
   - 验证主图标识更新
5. 删除图片:
   - 删除非主图图片
   - 验证删除确认对话框
   - 验证图片从列表移除
6. 拖拽排序:
   - 拖拽图片改变顺序
   - 验证顺序保存成功

## 库存管理模块测试

### TC006: 库存录入与更新
**测试路径**: `/inventory/finished-inventory` → 新建库存 → 库存列表

**测试步骤**:
1. 导航到成品库存页面
2. 点击"新建库存"按钮
3. 选择产品: "iPhone 15 Pro Max 256GB 黑色"
4. 输入库存数量: 500
5. 选择存储位置: "A区-货架1-层1"
6. 输入批次号: "BATCH-2024-TEST-001"
7. 点击"保存"按钮
8. 验证库存列表显示新记录
9. 验证库存数量正确显示

### TC007: 库存状态可视化
**测试路径**: `/inventory/finished-inventory` → 库存状态查看

**测试场景**:
1. **库存水平指示器**
   - 验证低库存红色警告
   - 验证正常库存绿色显示
   - 验证高库存黄色提醒

2. **库存预警测试**
   - 设置低库存阈值
   - 验证预警提示出现
   - 验证预警邮件发送

3. **库存历史记录**
   - 点击库存记录查看详情
   - 验证历史变动记录
   - 验证操作人信息

### TC008: 库存盘点功能
**测试路径**: `/inventory/finished-inventory` → 盘点 → 差异处理

**测试步骤**:
1. 选择库存记录
2. 点击"盘点"按钮
3. 输入实际盘点数量: 495
4. 系统显示差异: -5
5. 选择差异原因: "正常损耗"
6. 输入备注信息
7. 确认调整
8. 验证库存数量更新为495
9. 验证盘点记录生成

## 采购管理模块测试

### TC009: 完整采购订单流程
**测试路径**: `/purchase/purchase-orders` → 新建订单 → 审批 → 供应商响应

**测试步骤**:
1. 导航到采购订单页面
2. 点击"新建采购订单"
3. 选择供应商: "深圳华强北电子有限公司"
4. 选择店铺: "智能科技旗舰店"
5. 添加采购产品:
   - 产品: "iPhone 15 Pro Max 256GB 黑色"
   - 数量: 100台
   - 单价: ¥5,000
   - 总金额: ¥500,000
6. 设置交货日期: 2024-03-15
7. 添加备注: "测试采购订单"
8. 点击"保存并提交审批"
9. 使用管理员账户登录审批
10. 点击"审批通过"
11. 生成共享链接
12. 验证供应商可访问共享订单

**状态验证**:
- [ ] 订单状态从"已创建" → "待确认" → "已确认"
- [ ] 审批记录正确显示
- [ ] 共享链接有效且安全

### TC010: 供应商订单共享
**测试路径**: 共享链接 → 供应商门户 → 报价提交

**测试步骤**:
1. 生成采购订单共享链接
2. 复制共享链接
3. 在无痕浏览器中打开链接
4. 验证无需登录即可查看
5. 查看订单详细信息
6. 输入供应商报价:
   - 单价: ¥4,800
   - 交货期: "7个工作日"
7. 提交报价
8. 返回ERP系统查看供应商响应
9. 验证报价信息正确显示

### TC011: 采购订单搜索与筛选
**测试路径**: `/purchase/purchase-orders` → 高级搜索

**测试场景**:
1. **按供应商筛选**
   - 选择供应商"深圳华强北电子有限公司"
   - 验证结果仅显示该供应商订单

2. **按状态筛选**
   - 选择状态"已确认"
   - 验证结果仅显示已确认订单

3. **按日期范围筛选**
   - 设置创建日期范围
   - 验证结果在指定范围内

4. **按紧急程度筛选**
   - 勾选"仅显示紧急订单"
   - 验证结果正确过滤

### TC012: 采购订单编辑与变更
**测试路径**: `/purchase/purchase-orders` → 订单详情 → 编辑

**测试步骤**:
1. 打开已创建的采购订单
2. 点击"编辑"按钮
3. 修改产品数量: 从100台改为120台
4. 修改交货日期
5. 添加变更备注
6. 保存变更
7. 验证变更记录生成
8. 验证通知发送给相关人员

## 包装任务模块测试

### TC013: 包装任务创建与分配
**测试路径**: `/warehouse/packaging-tasks` → 新建任务 → 任务分配

**测试步骤**:
1. 导航到包装任务页面
2. 点击"新建包装任务"
3. 输入任务名称: "iPhone春节礼品包装"
4. 选择店铺: "智能科技旗舰店"
5. 选择产品: "iPhone 15 Pro Max 256GB 黑色"
6. 设置包装数量: 50台
7. 分配操作员: "张包装"
8. 设置优先级: "高"
9. 添加特殊要求: "春节礼盒包装"
10. 点击"创建任务"
11. 验证任务列表显示新任务

### TC014: 包装进度实时更新
**测试路径**: `/warehouse/packaging-tasks` → 任务执行 → 进度更新

**测试步骤**:
1. 找到待执行的包装任务
2. 操作员点击"开始任务"
3. 验证状态变为"进行中"
4. 模拟包装过程:
   - 更新进度到25%
   - 更新进度到50%
   - 更新进度到75%
   - 更新进度到100%
5. 点击"完成任务"
6. 验证状态变为"已完成"
7. 验证完成时间记录
8. 验证任务历史记录

### TC015: 包装任务可视化
**测试路径**: `/warehouse/packaging-tasks` → 任务看板

**测试场景**:
1. **进度条显示**
   - 验证进度条颜色变化
   - 验证百分比数字显示

2. **状态颜色编码**
   - 待处理: 灰色
   - 进行中: 蓝色
   - 已完成: 绿色
   - 已取消: 红色

3. **任务统计**
   - 验证待处理任务计数
   - 验证进行中任务计数
   - 验证今日完成任务计数

## 运输管理模块测试

### TC016: 运输记录创建
**测试路径**: `/delivery/delivery-records` → 新建运输 → 运输跟踪

**测试步骤**:
1. 导航到运输记录页面
2. 点击"新建运输记录"
3. 选择货代: "顺丰国际物流"
4. 输入运输编号: "SHIP-TEST-001"
5. 选择运输渠道: "空运FBA专线"
6. 设置目的地: "美国亚马逊FBA仓库"
7. 输入FBA运输代码: "FBA123456789"
8. 设置仓库截止日期: 2024-03-10
9. 添加运输产品:
   - 产品: "iPhone 15 Pro Max 256GB 黑色"
   - 数量: 100台
10. 点击"创建运输记录"
11. 验证运输列表显示新记录

### TC017: 运输状态更新
**测试路径**: `/delivery/delivery-records` → 状态管理

**测试步骤**:
1. 打开运输记录详情
2. 更新运输状态:
   - 已发货 → 运输中 → 已到达 → 已完成
3. 每一步都添加状态备注
4. 验证状态时间线显示
5. 验证相关人员收到通知邮件
6. 验证库存自动扣减

### TC018: 运输追踪可视化
**测试路径**: `/delivery/delivery-records` → 追踪详情

**测试场景**:
1. **时间线显示**
   - 验证状态变更时间线
   - 验证操作人信息

2. **地图集成**
   - 验证运输轨迹显示
   - 验证地理位置标记

3. **预警提示**
   - 设置截止日期预警
   - 验证过期提醒

## 财务管理模块测试

### TC019: 财务报告生成
**测试路径**: `/finance/financial-reports` → 新建报告 → 数据验证

**测试步骤**:
1. 导航到财务报告页面
2. 点击"生成月度报告"
3. 选择月份: "2024年3月"
4. 选择店铺: "智能科技旗舰店"
5. 系统自动计算:
   - 总收入
   - 产品成本
   - 运输成本
   - 营销成本
   - 运营成本
   - 净利润
6. 验证计算公式正确性
7. 验证图表数据正确显示
8. 验证可导出PDF/Excel

### TC020: 财务数据钻取
**测试路径**: `/finance/financial-reports` → 报告详情 → 数据明细

**测试步骤**:
1. 打开财务报告详情
2. 点击收入数据区域
3. 验证显示收入明细
4. 点击成本数据区域
5. 验证显示成本构成
6. 验证图表交互功能
7. 验证数据导出功能

## 基础数据管理测试

### TC021: 供应商管理
**测试路径**: `/basic-data/suppliers` → 新建供应商 → 供应商详情

**测试步骤**:
1. 导航到供应商管理页面
2. 点击"新建供应商"
3. 填写完整信息:
   - 公司名称
   - 联系人信息
   - 银行信息
   - 联系方式
4. 上传供应商头像
5. 保存并验证列表显示

### TC022: 店铺管理
**测试路径**: `/basic-data/shops` → 新建店铺 → 权限配置

**测试步骤**:
1. 创建新店铺
2. 设置店铺信息
3. 分配店铺管理员
4. 验证数据隔离
5. 验证权限控制

## 系统管理测试

### TC023: 用户管理
**测试路径**: `/system/accounts` → 新建用户 → 角色分配

**测试步骤**:
1. 导航到用户管理页面
2. 点击"新建用户"
3. 输入用户信息:
   - 用户名
   - 邮箱
   - 手机号
4. 选择角色: "采购经理"
5. 设置初始密码
6. 发送邀请邮件
7. 验证用户激活流程

### TC024: 角色权限管理
**测试路径**: `/system/roles` → 新建角色 → 权限配置

**测试步骤**:
1. 创建新角色: "测试角色"
2. 配置模块权限:
   - 产品管理: 查看、编辑
   - 库存管理: 仅查看
   - 采购管理: 完整权限
3. 分配用户到角色
4. 验证权限生效
5. 测试权限边界

## 响应式设计测试

### TC025: 移动端适配测试
**测试路径**: 全站移动端适配

**测试场景**:
1. **iPhone 12测试**
   - 验证导航栏折叠
   - 验证表格横向滚动
   - 验证按钮大小合适

2. **iPad测试**
   - 验证侧边栏显示
   - 验证表格布局
   - 验证触摸操作

3. **Android测试**
   - 验证Chrome浏览器兼容
   - 验证触摸反馈
   - 验证键盘弹出

## 性能测试场景

### TC026: 页面加载性能
**测试路径**: 关键页面加载时间

**测试指标**:
1. **登录页面**: < 2秒
2. **仪表板**: < 3秒
3. **产品列表**: < 3秒
4. **库存列表**: < 3秒
5. **订单列表**: < 3秒

### TC027: 大数据量测试
**测试路径**: 大数据场景下的前端性能

**测试场景**:
1. **1000个产品列表**
   - 验证分页功能
   - 验证搜索响应时间
   - 验证滚动性能

2. **5000条库存记录**
   - 验证筛选性能
   - 验证导出功能
   - 验证内存使用

## 错误处理测试

### TC028: 网络异常处理
**测试路径**: 模拟网络问题

**测试场景**:
1. **网络断开**
   - 模拟WiFi断开
   - 验证离线提示
   - 验证重试机制

2. **服务器错误**
   - 模拟500错误
   - 验证错误页面
   - 验证重试按钮

3. **超时处理**
   - 模拟请求超时
   - 验证超时提示
   - 验证自动重试

### TC029: 表单验证测试
**测试路径**: 全站表单验证

**测试场景**:
1. **必填字段验证**
   - 留空必填字段
   - 验证错误提示
   - 验证焦点定位

2. **格式验证**
   - 邮箱格式验证
   - 电话号码验证
   - 数字范围验证

3. **实时验证**
   - 输入时实时检查
   - 验证延迟显示
   - 验证错误清除

## 无障碍访问测试

### TC030: 键盘导航测试
**测试路径**: 全站键盘访问

**测试场景**:
1. **Tab键导航**
   - 验证Tab顺序逻辑
   - 验证焦点指示器
   - 验证键盘陷阱

2. **快捷键测试**
   - 验证全局快捷键
   - 验证上下文菜单
   - 验证键盘操作

### TC031: 屏幕阅读器测试
**测试路径**: 无障碍标签和提示

**测试场景**:
1. **ARIA标签**
   - 验证按钮标签
   - 验证表单标签
   - 验证状态提示

2. **焦点管理**
   - 验证模态框焦点
   - 验证错误提示焦点
   - 验证页面跳转焦点

## 测试执行清单

### 冒烟测试清单
- [ ] 用户登录和退出
- [ ] 产品创建和查看
- [ ] 库存录入和更新
- [ ] 采购订单创建
- [ ] 包装任务管理
- [ ] 运输记录创建
- [ ] 财务报告生成

### 回归测试清单
- [ ] 所有链接正常工作
- [ ] 表单提交无错误
- [ ] 搜索功能正常
- [ ] 分页功能正常
- [ ] 权限控制有效
- [ ] 响应式设计正常
- [ ] 浏览器兼容性

### 发布前检查清单
- [ ] 所有测试用例通过
- [ ] 性能指标达标
- [ ] 安全测试完成
- [ ] 无障碍测试通过
- [ ] 文档更新完整
- [ ] 用户培训完成

## 测试数据管理

### 测试数据库重置脚本
```sql
-- 测试前清理
DELETE FROM products WHERE code LIKE 'TEST-%';
DELETE FROM purchase_orders WHERE order_number LIKE 'TEST-%';
DELETE FROM finished_inventory WHERE batch_number LIKE 'TEST-%';

-- 插入测试基础数据
INSERT INTO shops (name, code) VALUES 
('测试店铺', 'TEST-SHOP');
INSERT INTO suppliers (name, contact_person) VALUES 
('测试供应商', '测试联系人');
```

### 测试报告模板
```markdown
# E2E测试报告

## 测试执行信息
- **执行日期**: 2024-03-XX
- **执行人员**: [测试人员]
- **测试环境**: [测试环境]
- **浏览器版本**: [版本信息]

## 测试结果统计
- **总用例数**: XX
- **通过用例**: XX
- **失败用例**: XX
- **阻塞用例**: XX
- **通过率**: XX%

## 缺陷统计
- **严重缺陷**: XX
- **中等缺陷**: XX
- **轻微缺陷**: XX

## 测试结论
[测试结论和建议]
```