# ERPç³»ç»ŸE2Eæµ‹è¯•å¼€å‘è®¡åˆ’

## é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£åˆ¶å®šäº†Easy ERPç³»ç»Ÿçš„ç«¯åˆ°ç«¯(E2E)æµ‹è¯•å¼€å‘è®¡åˆ’ï¼Œæ—¨åœ¨ç¡®ä¿æ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½çš„å‰åŽç«¯é›†æˆæ­£å¸¸å·¥ä½œã€‚æµ‹è¯•å°†è¦†ç›–å®Œæ•´çš„CRUDæ“ä½œå’Œå…³é”®ä¸šåŠ¡æµç¨‹ã€‚

## æµ‹è¯•æž¶æž„è®¾è®¡

### 1. ç™»å½•ä¾èµ–è§£å†³æ–¹æ¡ˆ

**é—®é¢˜åˆ†æžï¼š**
- æ‰€æœ‰åŠŸèƒ½æ¨¡å—éƒ½éœ€è¦ç”¨æˆ·ç™»å½•åŽæ‰èƒ½è®¿é—®
- å½“å‰ç™»å½•å­˜åœ¨éªŒè¯ç éªŒè¯ï¼Œå¢žåŠ äº†æµ‹è¯•å¤æ‚åº¦
- éœ€è¦ç¡®ä¿æµ‹è¯•æ•°æ®çš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§

**è§£å†³æ–¹æ¡ˆï¼š**
1. **Sessionç®¡ç†**ï¼šä½¿ç”¨Cypressçš„`cy.session()`ç¡®ä¿ç™»å½•çŠ¶æ€åœ¨æµ‹è¯•é—´å¤ç”¨
2. **APIç™»å½•**ï¼šé€šè¿‡APIç›´æŽ¥ç™»å½•ï¼Œç»•è¿‡UIéªŒè¯ç é™åˆ¶
3. **Mockç™»å½•**ï¼šåœ¨æµ‹è¯•çŽ¯å¢ƒä¸­mockç™»å½•å“åº”
4. **æµ‹è¯•ç”¨æˆ·**ï¼šä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•è´¦æˆ·ï¼Œé¿å…å½±å“ç”Ÿäº§æ•°æ®

### 2. æµ‹è¯•æ•°æ®ç®¡ç†

**ç­–ç•¥ï¼š**
- ä½¿ç”¨fixturesæ–‡ä»¶ç®¡ç†æµ‹è¯•æ•°æ®
- æ¯ä¸ªæµ‹è¯•æ¨¡å—ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®é›†
- æµ‹è¯•å‰æ¸…ç†ï¼Œæµ‹è¯•åŽæ¢å¤
- ä½¿ç”¨å”¯ä¸€æ ‡è¯†ç¬¦é¿å…æ•°æ®å†²çª

### 3. æµ‹è¯•åˆ†å±‚æž¶æž„

```
â”œâ”€â”€ Unit Tests (å•å…ƒæµ‹è¯•)
â”œâ”€â”€ Integration Tests (é›†æˆæµ‹è¯•)
â””â”€â”€ E2E Tests (ç«¯åˆ°ç«¯æµ‹è¯•)
    â”œâ”€â”€ Auth Module (è®¤è¯æ¨¡å—)
    â”œâ”€â”€ Core Business Modules (æ ¸å¿ƒä¸šåŠ¡æ¨¡å—)
    â”œâ”€â”€ System Management (ç³»ç»Ÿç®¡ç†)
    â””â”€â”€ End-to-End Workflows (ç«¯åˆ°ç«¯ä¸šåŠ¡æµç¨‹)
```

## æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•è®¡åˆ’

### Phase 1: åŸºç¡€æ¨¡å—æµ‹è¯• (å·²å®Œæˆ)

#### âœ… 1.1 è®¤è¯æ¨¡å— (Auth)
- [x] ç”¨æˆ·ç™»å½•åŠŸèƒ½
- [x] ç™»å½•è¡¨å•éªŒè¯
- [x] ç™»å½•æˆåŠŸè·³è½¬
- [x] ç™»å½•å¤±è´¥å¤„ç†

### Phase 2: æ ¸å¿ƒä¸šåŠ¡æ¨¡å—æµ‹è¯• (è¿›è¡Œä¸­)

#### ðŸ”„ 2.1 äº§å“ç®¡ç†æ¨¡å— (Products)
**æµ‹è¯•èŒƒå›´ï¼š**
- [x] äº§å“åˆ—è¡¨æŸ¥çœ‹
- [x] åˆ›å»ºæ–°äº§å“
- [x] ç¼–è¾‘äº§å“ä¿¡æ¯
- [x] äº§å“è¯¦æƒ…æŸ¥çœ‹
- [ ] äº§å“åˆ é™¤åŠŸèƒ½
- [ ] äº§å“æœç´¢å’Œç­›é€‰
- [ ] äº§å“åˆ†ç±»ç®¡ç†
- [ ] æ‰¹é‡æ“ä½œ

**å¾…å®Œå–„æµ‹è¯•ç”¨ä¾‹ï¼š**
```javascript
// äº§å“åˆ é™¤
it('åˆ é™¤äº§å“', () => {
  // æµ‹è¯•åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
  // æµ‹è¯•åˆ é™¤æˆåŠŸ
  // æµ‹è¯•åˆ é™¤åŽåˆ—è¡¨æ›´æ–°
})

// äº§å“æœç´¢
it('äº§å“æœç´¢åŠŸèƒ½', () => {
  // æŒ‰åç§°æœç´¢
  // æŒ‰ç¼–ç æœç´¢
  // æŒ‰åˆ†ç±»ç­›é€‰
})
```

#### ðŸ”„ 2.2 åº“å­˜ç®¡ç†æ¨¡å— (Inventory)
**æµ‹è¯•èŒƒå›´ï¼š**
- [x] åº“å­˜åˆ—è¡¨æ˜¾ç¤º
- [x] åº“å­˜çŠ¶æ€æ ‡è¯†
- [x] åº“å­˜ç­›é€‰åŠŸèƒ½
- [x] åº“å­˜å…¥åº“æ“ä½œ
- [x] åº“å­˜å‡ºåº“æ“ä½œ
- [ ] åº“å­˜ç›˜ç‚¹åŠŸèƒ½
- [ ] åº“å­˜é¢„è­¦è®¾ç½®
- [ ] åº“å­˜æŠ¥è¡¨æŸ¥çœ‹

**å¾…å®Œå–„æµ‹è¯•ç”¨ä¾‹ï¼š**
```javascript
// åº“å­˜ç›˜ç‚¹
it('åº“å­˜ç›˜ç‚¹åŠŸèƒ½', () => {
  // åˆ›å»ºç›˜ç‚¹ä»»åŠ¡
  // å½•å…¥ç›˜ç‚¹æ•°æ®
  // ç”Ÿæˆç›˜ç‚¹å·®å¼‚æŠ¥å‘Š
})
```

#### ðŸ”„ 2.3 é‡‡è´­ç®¡ç†æ¨¡å— (Purchase)
**æµ‹è¯•èŒƒå›´ï¼š**
- [x] é‡‡è´­è®¢å•åˆ—è¡¨
- [x] åˆ›å»ºé‡‡è´­è®¢å•
- [x] é‡‡è´­è®¢å•å®¡æ‰¹
- [ ] é‡‡è´­è®¢å•ä¿®æ”¹
- [ ] é‡‡è´­è®¢å•å–æ¶ˆ
- [ ] ä¾›åº”å•†ç®¡ç†
- [ ] é‡‡è´­æ”¶è´§ç¡®è®¤
- [ ] é‡‡è´­ä»˜æ¬¾è®°å½•

**å¾…å®Œå–„æµ‹è¯•ç”¨ä¾‹ï¼š**
```javascript
// é‡‡è´­æ”¶è´§
it('é‡‡è´­æ”¶è´§ç¡®è®¤', () => {
  // é€‰æ‹©å¾…æ”¶è´§è®¢å•
  // å½•å…¥å®žé™…æ”¶è´§æ•°é‡
  // ç¡®è®¤æ”¶è´§å¹¶æ›´æ–°åº“å­˜
})
```

### Phase 3: æ‰©å±•ä¸šåŠ¡æ¨¡å—æµ‹è¯• (å¾…å¼€å§‹)

#### ðŸ“‹ 3.1 åŸºç¡€æ•°æ®ç®¡ç†
**æ¨¡å—ï¼š**
- ä¾›åº”å•†ç®¡ç† (`/basic-data/suppliers`)
- é—¨åº—ç®¡ç† (`/basic-data/shops`)
- è´§ä»£ç®¡ç† (`/basic-data/forwarders`)

**æµ‹è¯•é‡ç‚¹ï¼š**
- CRUDæ“ä½œå®Œæ•´æ€§
- æ•°æ®éªŒè¯è§„åˆ™
- å…³è”æ•°æ®å¤„ç†

#### ðŸ“‹ 3.2 ä»“å‚¨ç®¡ç†
**æ¨¡å—ï¼š**
- åŒ…è£…ä»»åŠ¡ (`/warehouse/packaging-tasks`)
- æˆå“åº“å­˜ (`/inventory/finished-inventory`)
- å¤‡ä»¶åº“å­˜ (`/inventory/spare-inventory`)

#### ðŸ“‹ 3.3 é…é€ç®¡ç†
**æ¨¡å—ï¼š**
- é…é€è®°å½• (`/delivery/delivery-records`)

#### ðŸ“‹ 3.4 è´¢åŠ¡ç®¡ç†
**æ¨¡å—ï¼š**
- è´¢åŠ¡æŠ¥è¡¨ (`/finance/financial-reports`)

#### ðŸ“‹ 3.5 ç³»ç»Ÿç®¡ç†
**æ¨¡å—ï¼š**
- è´¦æˆ·ç®¡ç† (`/system/accounts`)
- è§’è‰²ç®¡ç† (`/system/roles`)
- ç³»ç»Ÿæ—¥å¿— (`/system/logs`)

### Phase 4: ç«¯åˆ°ç«¯ä¸šåŠ¡æµç¨‹æµ‹è¯• (éƒ¨åˆ†å®Œæˆ)

#### ðŸ”„ 4.1 é‡‡è´­åˆ°ä»˜æ¬¾æµç¨‹ (P2P)
- [x] åŸºç¡€æµç¨‹æ¡†æž¶
- [ ] å®Œæ•´ä¸šåŠ¡éªŒè¯
- [ ] å¼‚å¸¸æƒ…å†µå¤„ç†

#### ðŸ“‹ 4.2 è®¢å•åˆ°æ”¶æ¬¾æµç¨‹ (O2C)
- [ ] é”€å”®è®¢å•åˆ›å»º
- [ ] åº“å­˜åˆ†é…
- [ ] å‘è´§é…é€
- [ ] æ”¶æ¬¾ç¡®è®¤

#### ðŸ“‹ 4.3 åº“å­˜è¡¥è´§æµç¨‹
- [ ] åº“å­˜é¢„è­¦è§¦å‘
- [ ] è‡ªåŠ¨è¡¥è´§å»ºè®®
- [ ] é‡‡è´­ç”³è¯·åˆ›å»º
- [ ] å…¥åº“æ›´æ–°åº“å­˜

## æµ‹è¯•å®žæ–½è®¡åˆ’

### ç¬¬ä¸€å‘¨ï¼šå®Œå–„æ ¸å¿ƒæ¨¡å—æµ‹è¯•

**Day 1-2: äº§å“ç®¡ç†æ¨¡å—å®Œå–„**
- [ ] æ·»åŠ äº§å“åˆ é™¤æµ‹è¯•
- [ ] æ·»åŠ äº§å“æœç´¢ç­›é€‰æµ‹è¯•
- [ ] æ·»åŠ äº§å“åˆ†ç±»ç®¡ç†æµ‹è¯•
- [ ] æ·»åŠ æ‰¹é‡æ“ä½œæµ‹è¯•

**Day 3-4: åº“å­˜ç®¡ç†æ¨¡å—å®Œå–„**
- [ ] æ·»åŠ åº“å­˜ç›˜ç‚¹æµ‹è¯•
- [ ] æ·»åŠ åº“å­˜é¢„è­¦æµ‹è¯•
- [ ] æ·»åŠ åº“å­˜æŠ¥è¡¨æµ‹è¯•

**Day 5: é‡‡è´­ç®¡ç†æ¨¡å—å®Œå–„**
- [ ] æ·»åŠ é‡‡è´­æ”¶è´§æµ‹è¯•
- [ ] æ·»åŠ é‡‡è´­ä»˜æ¬¾æµ‹è¯•

### ç¬¬äºŒå‘¨ï¼šåŸºç¡€æ•°æ®æ¨¡å—æµ‹è¯•

**Day 1-2: ä¾›åº”å•†ç®¡ç†**
```javascript
describe('ä¾›åº”å•†ç®¡ç†æ¨¡å—', () => {
  beforeEach(() => {
    cy.loginAsAdmin()
    cy.visit('/basic-data/suppliers')
  })
  
  it('ä¾›åº”å•†CRUDæ“ä½œ', () => {
    // åˆ›å»ºã€æŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤ä¾›åº”å•†
  })
})
```

**Day 3: é—¨åº—ç®¡ç†**
**Day 4: è´§ä»£ç®¡ç†**
**Day 5: é›†æˆæµ‹è¯•å’Œä¿®å¤**

### ç¬¬ä¸‰å‘¨ï¼šä»“å‚¨å’Œé…é€æ¨¡å—

**Day 1-2: ä»“å‚¨ç®¡ç†æµ‹è¯•**
**Day 3-4: é…é€ç®¡ç†æµ‹è¯•**
**Day 5: è´¢åŠ¡æ¨¡å—æµ‹è¯•**

### ç¬¬å››å‘¨ï¼šç³»ç»Ÿç®¡ç†å’Œç«¯åˆ°ç«¯æµç¨‹

**Day 1-2: ç³»ç»Ÿç®¡ç†æ¨¡å—**
**Day 3-4: å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•**
**Day 5: æµ‹è¯•ä¼˜åŒ–å’Œæ–‡æ¡£å®Œå–„**

## æŠ€æœ¯å®žæ–½ç»†èŠ‚

### 1. æµ‹è¯•çŽ¯å¢ƒé…ç½®

```javascript
// cypress.config.js
module.exports = {
  e2e: {
    baseUrl: 'http://localhost:3000',
    env: {
      apiBaseUrl: 'http://localhost:3000/api/v1',
      adminUser: 'admin',
      adminPassword: 'admin123',
      testDataCleanup: true
    }
  }
}
```

### 2. é€šç”¨æµ‹è¯•å·¥å…·å‡½æ•°

```javascript
// éªŒè¯é¡µé¢æ ‡é¢˜
Cypress.Commands.add('verifyPageTitle', (title) => {
  cy.contains('h1, .page-title, .ant-page-header-heading-title', title)
    .should('be.visible')
})

// éªŒè¯æˆåŠŸæ¶ˆæ¯
Cypress.Commands.add('verifySuccessMessage', (message) => {
  cy.get('.ant-message-success, .ant-notification-notice-success')
    .should('contain', message)
})

// éªŒè¯è¡¨å•éªŒè¯
Cypress.Commands.add('verifyFormValidation', (fieldName, errorMessage) => {
  cy.get(`[name="${fieldName}"]`)
    .parent()
    .should('contain', errorMessage)
})
```

### 3. æµ‹è¯•æ•°æ®ç®¡ç†

```javascript
// cypress/fixtures/test-data.json
{
  "products": {
    "testProduct": {
      "name": "æµ‹è¯•äº§å“_" + Date.now(),
      "code": "TEST_" + Date.now(),
      "sku": "SKU_" + Date.now(),
      "category": "æ™ºèƒ½å®¶å±…"
    }
  },
  "suppliers": {
    "testSupplier": {
      "name": "æµ‹è¯•ä¾›åº”å•†_" + Date.now(),
      "contact": "å¼ ä¸‰",
      "phone": "13800138000"
    }
  }
}
```

### 4. APIæ‹¦æˆªå’ŒMock

```javascript
// æ‹¦æˆªAPIè¯·æ±‚è¿›è¡ŒéªŒè¯
beforeEach(() => {
  cy.intercept('GET', '/api/v1/products*').as('getProducts')
  cy.intercept('POST', '/api/v1/products').as('createProduct')
  cy.intercept('PUT', '/api/v1/products/*').as('updateProduct')
  cy.intercept('DELETE', '/api/v1/products/*').as('deleteProduct')
})
```

## è´¨é‡ä¿è¯

### 1. æµ‹è¯•è¦†ç›–çŽ‡ç›®æ ‡
- **åŠŸèƒ½è¦†ç›–çŽ‡**: 90%ä»¥ä¸Š
- **é¡µé¢è¦†ç›–çŽ‡**: 100%
- **APIè¦†ç›–çŽ‡**: 85%ä»¥ä¸Š

### 2. æµ‹è¯•ç¨³å®šæ€§
- æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡çŽ‡ > 95%
- æµ‹è¯•æ‰§è¡Œæ—¶é—´ < 30åˆ†é’Ÿ
- æ— ç‰‡çŠ¶æµ‹è¯•(flaky tests)

### 3. æŒç»­é›†æˆ
- GitHub Actionsè‡ªåŠ¨åŒ–æµ‹è¯•
- æ¯æ¬¡PRè‡ªåŠ¨è¿è¡Œæµ‹è¯•
- æµ‹è¯•æŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆ

## é£Žé™©å’ŒæŒ‘æˆ˜

### 1. æŠ€æœ¯é£Žé™©
- **éªŒè¯ç å¤„ç†**: å·²é€šè¿‡APIç™»å½•è§£å†³
- **å¼‚æ­¥æ“ä½œ**: ä½¿ç”¨é€‚å½“çš„ç­‰å¾…ç­–ç•¥
- **æ•°æ®ä¾èµ–**: é€šè¿‡æµ‹è¯•æ•°æ®éš”ç¦»è§£å†³

### 2. ä¸šåŠ¡é£Žé™©
- **æ•°æ®ä¸€è‡´æ€§**: æµ‹è¯•å‰åŽæ•°æ®æ¸…ç†
- **æƒé™æŽ§åˆ¶**: ä½¿ç”¨æµ‹è¯•ä¸“ç”¨è´¦æˆ·
- **ä¸šåŠ¡é€»è¾‘å˜æ›´**: åŠæ—¶æ›´æ–°æµ‹è¯•ç”¨ä¾‹

### 3. ç»´æŠ¤æˆæœ¬
- **æµ‹è¯•ç”¨ä¾‹ç»´æŠ¤**: å»ºç«‹æ¸…æ™°çš„æµ‹è¯•ç»“æž„
- **æµ‹è¯•æ•°æ®ç®¡ç†**: è‡ªåŠ¨åŒ–æµ‹è¯•æ•°æ®ç”Ÿæˆ
- **çŽ¯å¢ƒä¾èµ–**: å®¹å™¨åŒ–æµ‹è¯•çŽ¯å¢ƒ

## æˆåŠŸæŒ‡æ ‡

### 1. çŸ­æœŸç›®æ ‡ (2å‘¨å†…)
- [ ] å®Œæˆæ‰€æœ‰æ ¸å¿ƒæ¨¡å—çš„åŸºç¡€CRUDæµ‹è¯•
- [ ] å»ºç«‹ç¨³å®šçš„æµ‹è¯•ç™»å½•æœºåˆ¶
- [ ] å®žçŽ°æµ‹è¯•æ•°æ®è‡ªåŠ¨ç®¡ç†

### 2. ä¸­æœŸç›®æ ‡ (1ä¸ªæœˆå†…)
- [ ] å®Œæˆæ‰€æœ‰ä¸šåŠ¡æ¨¡å—çš„æµ‹è¯•è¦†ç›–
- [ ] å»ºç«‹ç«¯åˆ°ç«¯ä¸šåŠ¡æµç¨‹æµ‹è¯•
- [ ] é›†æˆCI/CDè‡ªåŠ¨åŒ–æµ‹è¯•

### 3. é•¿æœŸç›®æ ‡ (2ä¸ªæœˆå†…)
- [ ] è¾¾åˆ°90%ä»¥ä¸Šçš„æµ‹è¯•è¦†ç›–çŽ‡
- [ ] å»ºç«‹å®Œæ•´çš„æµ‹è¯•æ–‡æ¡£å’Œæœ€ä½³å®žè·µ
- [ ] å®žçŽ°æµ‹è¯•é©±åŠ¨çš„å¼€å‘æµç¨‹

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œ (ä»Šå¤©)
1. **å®Œå–„äº§å“ç®¡ç†æµ‹è¯•**
   - æ·»åŠ äº§å“åˆ é™¤åŠŸèƒ½æµ‹è¯•
   - æ·»åŠ äº§å“æœç´¢ç­›é€‰æµ‹è¯•
   - éªŒè¯å‰åŽç«¯APIé›†æˆ

2. **ä¼˜åŒ–ç™»å½•æœºåˆ¶**
   - ç¡®ä¿ç™»å½•çŠ¶æ€åœ¨æ‰€æœ‰æµ‹è¯•ä¸­ç¨³å®š
   - æ·»åŠ ç™»å½•å¤±è´¥çš„é”™è¯¯å¤„ç†

3. **å»ºç«‹æµ‹è¯•æ•°æ®ç®¡ç†**
   - åˆ›å»ºç‹¬ç«‹çš„æµ‹è¯•æ•°æ®é›†
   - å®žçŽ°æµ‹è¯•å‰åŽæ•°æ®æ¸…ç†

### æœ¬å‘¨è®¡åˆ’
- å‘¨ä¸€ï¼šå®Œå–„äº§å“ç®¡ç†æ¨¡å—æµ‹è¯•
- å‘¨äºŒï¼šå®Œå–„åº“å­˜ç®¡ç†æ¨¡å—æµ‹è¯•
- å‘¨ä¸‰ï¼šå®Œå–„é‡‡è´­ç®¡ç†æ¨¡å—æµ‹è¯•
- å‘¨å››ï¼šå¼€å§‹åŸºç¡€æ•°æ®æ¨¡å—æµ‹è¯•
- å‘¨äº”ï¼šæµ‹è¯•æ•´åˆå’Œé—®é¢˜ä¿®å¤

---

**æ–‡æ¡£ç»´æŠ¤**: æœ¬è®¡åˆ’å°†æ ¹æ®å®žé™…è¿›å±•æŒç»­æ›´æ–°
**æœ€åŽæ›´æ–°**: 2024å¹´12æœˆ19æ—¥
**è´Ÿè´£äºº**: AI Assistant
**å®¡æ ¸äºº**: å¾…å®š